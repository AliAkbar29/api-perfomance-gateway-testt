# Pengaturan ini mengontrol Nginx di bawah Kong untuk menangani beban tinggi.

# Gunakan semua core CPU yang tersedia. Pilihan terbaik untuk produksi.
nginx_worker_processes = 16

# Jumlah koneksi maksimum per worker. Nilai ini harus sesuai dengan batas ulimit -n sistem Anda.
# Total koneksi maks = worker_processes * worker_connections
# Contoh: 8 core * 16384 = 131,072 koneksi. Pastikan ulimit Anda lebih tinggi dari ini.
nginx_worker_connections = 16384

# Mengaktifkan kembali koneksi ke layanan backend (upstream).
# Ini sangat penting untuk mengurangi latensi karena Kong tidak perlu membuat koneksi TCP/SSL baru untuk setiap request.
upstream_keepalive_pool_size = 512         # Jumlah koneksi idle yang disimpan per upstream. Naikkan jika Anda punya banyak backend.
upstream_keepalive_max_requests = 1000     # Jumlah request yang bisa dilayani oleh satu koneksi keep-alive sebelum ditutup.
upstream_keepalive_timeout = 60s           # Waktu idle (detik) sebelum koneksi keep-alive ditutup.